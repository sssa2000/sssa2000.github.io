---
layout: post
title: "和LCD有关的一些知识总结"
date: 2014-05-19 00:05
comments: true
categories: 
---

前一段时间，开发炫舞2跑酷模式中，我们遇到了一些卡顿的问题。在寻找问题的解决方法的过程中，对LCD的一些特性做过一些了解，特别整理一下。


----------
<!--more-->

##人眼特点
* 特点1：人眼无法识别每秒48次以上的闪烁。例如日光灯、CRT显示器都是在不断的闪烁，人眼一般毫无察觉。
* 特点2：人眼观察运动的物体时，对物体的运动是有预测的。
* 特点3：人类的眼睛在看动态画面时，对大脑传送的讯号是自动对亮度状况做的积分。也就是说人眼对动态画面做的自动平滑处理，也即：对亮度的空间和时间的变化做积分。



----------


##CRT显示器
要说LCD显示器，就不得不说一下CRT显示器。不得不说，CRT显示器是一个技术相当成熟的东西，无论是成像还是色彩还是成本，在目前来看都要比LCD好。当然便携性、外观、能耗上CRT确实比不过LCD。
{% img/images/lcd/1.jpg %}
 

CRT的工作原理什么的就不复制黏贴了，这里只说和本文有关的两个要点：
1、	电子枪逐行扫描，发射电子。
2、	电子击中屏幕磷光粉，磷光粉发出短暂的亮起，然后又恢复黑暗状态。

###CRT的刷新率
CRT显示器的电子枪构造决定了CRT是具有固定刷新率的。最常见的民用CRT显示器刷新率是75Hz，这意味着在CRT显示器中，每秒钟可以显示75帧图像，而且屏幕每秒会从亮到暗闪烁75次。

为了配合CRT的显示，显卡中有一个部件叫“视频控制器”，视频控制器会根据显示器的刷新率，对FrameBuffer进行采样，并进行数模转换（如果需要的话），把信号输出给显示器。


----------


##LCD显示器
LCD的基本原理是：

* 当向液晶通电时，液晶体分子排列可以使光线容易通过；
* 不通电时，液晶分子排列混乱，阻止光线通过。

早期的LCD低端面板受到成本制约，依然采用逐行扫描的方式，不过扫描花费的时间比CRT快多了。有人问，LCD没有电子枪怎么逐行扫描？其实很简单，因为显卡中的视频控制器是逐行扫描FrameBuffer的，视频控制器每次只向LCD输出一行的数据，就实现了逐行扫描。

不过近年来高端面板例如TFT面板也越来越普及，它的每个液晶像素点都是由集成在像素点后面的薄膜晶体管来驱动。这就能做到整屏幕控制了。

和CRT显示器最大的不同的是：LCD在画完一帧以后，会一直保持画面，直到绘制下一帧。
###响应时间
ISO规定的全程响应（白->黑->白）时间的定义：全程响应时间=上升时间(Ton)+下降时间(Toff)。

 - 一个像素点从白色转为黑色，电极电压从0变为最大值，即最大电压激励状态下，液晶分子迅速转换到新的位置，这一过程所用的时间被称为上升时间；
 - 一个像素有黑转白，像素所加电压切断，液晶分子迅速回到加电前的位置，这一过程成为下降时间。

事实上，从全白到全黑，液晶分子对应的是最大的扭转角度，此时需要加上较大的电压，液晶分子扭转速度较快；然而处于中间阶调的较小幅度的灰阶变化，则需要施加较小的电压进行精细的角度控制，液晶分子扭转速度要慢一些。一般而言，LCD显示器黑白间的响应时间最快，而中间灰阶之间的响应时间要比黑白间响应时间慢很多。

响应时间会直接影响到画面的质量：如果液晶的响应时间大于帧的间隔时间，人观看快速运动的画面时就会感觉到画面有拖影。
###LCD的刷新率
CRT显示器中，刷新率是一个固定值，你可以简单的认为CRT的刷新率就是：每秒亮暗的次数。

LCD是常亮的，它的刷新率和响应时间有关系。不幸的是，LCD的响应时间并不是一个固定值，不同灰阶之间的响应时间都可能长短不一。所以，对LCD来说，刷新率可能不是一个固定的精确的值，这个数据存在的意义是为了适应历史兼容性，以及视频控制器的输出。


显卡中的“视频控制器”会根据操作系统中设置好的刷新率向LCD显示器输出信号，如果该LCD显示器的响应时间为16ms的话，那么它的刷新率就是1000/16=63。

###Eye tracking和Motion Blur的问题
在游戏或者其他图形程序上，经常会有Eye tracking的需求。也就是屏幕上有物体在持续运动，人眼跟随屏幕上运动的物体。

假设物体是沿一条直线运动，如下图最左边的图（横轴是时间，纵轴是距离）。那么在CRT显示器上，由于CRT显示器每次亮起的时候，都更新了物体的位置，所以眼睛从CRT上接受到的信号是下图中间的效果。
{% img/images/lcd/2.jpg %}

 
但是如果是在LCD显示器上，由于LCD显示器是常亮的，根据前面说的人眼的特点，人眼会自动对亮度做积分处理，人眼在两帧画面间的白屏做自动积分，让转换间的画面边缘模糊化，从而更加平滑。更平滑也就意味着更加模糊。


----------


##LCD常见的改进技术
###OverDrive技术
简而言之就是，施加更大的电压给液晶，让它更快的转动，达到加速响应时间的目的。但是事情没这么简单，什么时候施加多大的电压，什么时间把电压减回去，这可是个讲究的活。各大厂商都有自己的创新，例如下面几个其实都是说的OverDrive技术。
* Sony的ClearMotiv
* BenQ的AMA（Advanced Motion Accelerator）
* LG的ODC（Over Driving Circuit）
* NEC的RapidResponse
* …

当然OverDrive技术也不是万能药，用不好同样有问题。例如电压加过头了会产生“Coronas”现象。感兴趣的可以看看《LCD Motion Artifacts 101: Introduction》

###Black Frame Insertion
**BFI (Black Frame Insertion**)是明基于2006年首次提出并运用。基本思想就是模仿CRT的脉冲式显示，在不同的帧之间插入黑帧，让眼睛自动平滑的特性失效，获得锐利的动态图像。
{% img/images/lcd/3.jpg %}
 
###Scanning Backlight
Scanning Backlight是通过关闭打开LCD的背光来模拟CRT的脉冲式显示。通常Scanning Backlight和BFI会同时使用。

Scanning Backlight的优点是不会增加画面的输入延迟，但是会降低画面的亮度；
BFI则正好相反。

这两个技术也被各大厂商广为使用，例如：
* BenQ的AMA-Z
* 华硕的ASPD
* NEC 'Motion Picture Mode'
* Samsung Motion Picture Acceleration (MPA)
* …

###Motion Interpolation
简而言之就是，对运动物体进行插值生成新的帧。这也意味着输入的信号是60Hz，但是显示器输出的信号是大于60Hz的。这个LG是典型，TruMotion的规格从最早的120到现在的480Hz。

当然怎么进行线性插值、插入什么内容都是有讲究的，例如LG的TruMotion技术，240Hz的时候除了插入了一帧估计的画面还插入了两个黑帧。
{% img/images/lcd/4.jpg %}

 

各大厂商眼花缭乱的名词：

* LG - TruMotion 120 Hz, 240 Hz
* AOC - Motion Boost 120 Hz
* Philips - HD Digital Natural Motion
* Samsung - Auto Motion Plus 120 Hz, 240 Hz
* Sharp - Fine Motion Enhanced, AquoMotion 240Hz
* Sony – MotionFlow
* …

###提高LCD支持的刷新率上限
说到底，Motion Interpolation只是预测而已，如果能GPU输入的信号就有120Hz，那就更好了。显示器虽然对游戏的FPS无能为力，但是做好自身，先支持120Hz再说。

现在已经有不少显示器支持120Hz的刷新率，这样的话如果输入信号大于60Hz那就没必要傻等着垂直同步了。

###玻璃涂料
不得不说，这是取巧的做法，通过在面板上覆盖特质的涂料，让显示的画面获得更加锐利的效果。代表就是Apple的显示器。


----------


##参考
http://www.tftcentral.co.uk/
http://www.tftcentral.co.uk/


